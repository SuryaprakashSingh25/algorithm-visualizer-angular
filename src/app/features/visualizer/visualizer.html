<div class="container">
  <h1>Algorithm Visualizer</h1>

  <div class="controls">
    <div class="control-group">
      <label for="algo-select" class="label">Algorithm:</label>
      <select id="algo-select" [(ngModel)]="selectedAlgorithm" class="dropdown">
        <option *ngFor="let algo of algorithms" [value]="algo.id">
          {{ algo.name }}
        </option>
      </select>
    </div>

    <div class="button-group">
      <button class="btn btn-secondary" (click)="generateArray()" [disabled]="isPlaying" title="Generate a new random array">Generate Array</button>
      <button class="btn btn-primary" (click)="startSort(getSelectedAlgorithm())" [disabled]="isPlaying" title="Start visualizing the selected algorithm">Start</button>
      <button class="btn btn-secondary" (click)="nextStep()" [disabled]="isPlaying" title="Advance to the next step">Next Step</button>
      <button class="btn btn-success" (click)="play()" [disabled]="isPlaying" title="Auto-play the algorithm">Play</button>
      <button class="btn btn-warning" (click)="pause()" [disabled]="!isPlaying" title="Pause playback">Pause</button>
    </div>
  </div>

  <div class="info-panel" *ngIf="statusMessage">
    <div class="status-message">{{ statusMessage }}</div>
    <div class="merge-ranges" *ngIf="mergeInfo && selectedAlgorithm === 'binary-search'">
      <span class="bound-label">Lower Bound:</span>
      <span class="bound-values">{{ mergeInfo.left }}</span>
      <span class="bound-label">Upper Bound:</span>
      <span class="bound-values">{{ mergeInfo.right }}</span>
      <span class="level-label">Level {{ mergeInfo.level }}</span>
    </div>
    <div class="merge-ranges" *ngIf="mergeInfo && selectedAlgorithm !== 'binary-search'">
      <span class="range-label">Active Range:</span>
      <span class="range-values">[{{ mergeInfo.left }}..{{ mergeInfo.right }}]</span>
      <span class="level-label">Level {{ mergeInfo.level }}</span>
    </div>
  </div>

  <div class="array-container">
    <div
      class="bar"
      *ngFor="let value of array; let i = index"
      [style.height.px]="value * 3"
      [class.compare]="
        currentStepType === 'compare' && activeIndices.includes(i)
      "
      [class.swap]="currentStepType === 'swap' && activeIndices.includes(i)"
      [class.overwrite]="
        currentStepType === 'overwrite' && activeIndices.includes(i)
      "
      [class.sorted]="sortedIndices.includes(i)"
      [class.in-search-range]="selectedAlgorithm === 'binary-search' && i >= searchLeft && i <= searchRight"
      [class.out-of-range]="selectedAlgorithm === 'binary-search' && (i < searchLeft || i > searchRight)"
    ></div>
  </div>

  <div class="speed-control">
    <label for="speed-slider">Playback Speed:</label>
    <input id="speed-slider" type="range" min="200" max="2000" step="100" [(ngModel)]="speed" class="slider" />
    <span class="speed-value">{{ speed }}ms</span>
  </div>
</div>
